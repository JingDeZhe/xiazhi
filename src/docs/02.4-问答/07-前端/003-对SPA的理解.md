# 对 SPA 的理解

SPA 的重点就在于单页面，也就是说通过重写当前页面和用户进行交互，并不是跳转到不同的页面，因此用户操作过程中不会被页面刷新干扰。

## 优点

1. 提升用户体验
   由于不需要进行页面的跳转刷新，路由切换流畅不会闪烁，数据加载平滑，可以快速响应。
2. 减少服务器负担
   服务器不需要传送完整页面，只负责数据的维护，减少服务器负担。
3. 易于开发和维护
   现代 UI 框架对 SPA 开发的支持度很高。

## 缺点

1. 首次加载时间长
   SPA 首次加载页面时需要加载完整的 UI 框架和库，导致首屏加载事件较长。

   > 优化方法：代码分割，懒加载，CDN 优化等

2. SEO 优化问题
   SPA 的内容主要以 JS 生成，对 SEO 引擎优化不好。

   > 优化方法：SSR、SSG 等

## SPA 的基本实现

SPA 主要通过监听 URL 哈希变化来实现页面切换的效果。

1. 监听 URL 哈希变化
2. 哈希变化时将变化添加到历史记录中以实现前进后退，让路由的行为和寻常页面跳转保持一致
3. 更具哈希渲染不同的内容，因为存在子路由这样的东西，所以也并不是说一定就是全页面重写，可能只是重写一部分内容

## 路由

路由其实是 SPA 模拟 MPA 的一种方式，通过监听 URL 变化来呈现不同的路由内容。根据使用技术的不同，路由分为 hash 路由和 history 路由。

### hash 路由

hash 路由是通过 URL 的 Anchor 部分来区分路由的，由于 Anchor 的变化不会触发新的 http 请求，因此服务端不需要特别配置。
浏览器前进后退会触发 hash 的变化，通过监听 hashchange 事件来触发路由渲染。

### history 路由

history API 是 H5 新的 API，通过 history.pushState 或者 replaceState 来修改 URL 并且不向后台发送新的 http 请求，前进后退就监听 popstate 时间。
history API 的兼容性没有哈希模式好，但比起哈希模式更加符合传统页面的跳转习惯。
由于 history 模式虽然通过 pushState 和 replaceState 修改 URL 不会触发 http 请求，但如果在总中途刷新页面还是会发送一个对应路由的 URL，因此服务端需要将这种 URL 匹配到 index 页面上，这样才可以触发正常的跳转逻辑。
