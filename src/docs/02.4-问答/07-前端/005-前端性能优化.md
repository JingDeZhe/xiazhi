# 前端性能优化

既然提及到前端性能优化，那就先看一下是哪些原因导致前端性能需要优化：

1. 文件太大，比如说很大的 JS 或者 CSS 文件
2. 文件太多，比如说很多的零碎的小图片资源或者小 JS 或者 CSS 资源
3. 网络比较差，加载个文件就要很久
4. 页面逻辑不对，首屏的依赖超级多，导致用户看到的白屏或卡顿等特别明显

也就是说，前端优化主要就是针对以上的这些问题。

## 文件太大

页面卡顿最先想到的就是要加载的东西太大了，比如说现在的 SPA 应用，不做优化的情况下一个 main.js 就好几 M，自然会导致卡顿。
要解决问题最直观的想法就是将大的文件给拆分成几个耦合度小的小文件，注意这里的耦合度小，这是非常重要的。以首页为例，如果首页单纯只是为了展示一些基本信息或者目录，那自然也就不需要在一开始就去加载目录模块里的大头内容，就比如说内部的 ECharts 之类的库，这样一来，就可以将首页和目录的子页面拆开，从代码上来说就是将很大一团代码根据页面进行拆分。

需要注意的一点是，各个页面肯定会存在相同的依赖，比如说公共方法、公共组件、第三方组件库依赖等，这些在拆分的时候需要根据职责来，比如说一个很多地方用到了的 Table 组件可以拆分成一个 JS，很多地方用到了的 CSS 拆分为一个 CSS 等，对于第三方依赖，如 lodash、vue 等，一般也会拆分成单独的文件。

文件拆分之后，加载方式也就多了起来，比如说我们肯定是先进入首页，首页只需要加载很小的内容就可以呈现用户需要看到的页面，因此长时间的白屏就可以避免。后续的文件加载就不会太影响页面的呈现。

## 文件太碎

上面说了将大文件拆分成小文件，但也不是说拆分的越小越好，要根据逻辑来。但是对于某些文件，比如说页面上的图标，因为图标有很多，如果一个个加载那就是好几十个细碎的 http 请求，过多的 http 请求是不合适的，因此我们可以将这类小图标文件合并成一张大的精灵图，这样只需要加载一次就行。
